<html>
<head>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <link rel="stylesheet" href="jquery.mobile-1.4.3.min.css" />
	<script src="jquery-1.11.1.min.js"></script>
	<script src="jquery.mobile-1.4.3.min.js"></script>


	<script type="text/javascript" charset="utf-8">

	    var pictureSource;   // picture source
	    var destinationType; // sets the format of returned value

	    document.addEventListener("deviceready",onDeviceReady,false);

	    function onDeviceReady() {

	    	/* Camera */
	        pictureSource=navigator.camera.PictureSourceType;
	        destinationType=navigator.camera.DestinationType;

	        /* Connections */
	        setInterval(function(){
	        	checkConnection()
	        }, 3000);

	    }

	    function onPhotoDataSuccess(imageData) {
	      var image = document.getElementById('smallImage');
	      image.style.display = 'block';
	      image.src = "data:image/jpeg;base64," + imageData;
	    }

	    function onPhotoURISuccess(imageURI) {
	      var image = document.getElementById('smallImage');
	      image.style.display = 'block';
	      image.src = imageURI;
	    }

	    function capturePhoto() {
	      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
	        destinationType: destinationType.DATA_URL });
	    }

	    function getPhoto(source) {
	      navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50,
	        destinationType: destinationType.FILE_URI,
	        sourceType: source });
	    }

	    function onFail(message) {
	      alert('Failed because: ' + message);
	    }

	    function checkConnection() {
	        var networkState = navigator.connection.type;

	        var states = {};
	        states[Connection.UNKNOWN]  = 'Unknown connection';
	        states[Connection.ETHERNET] = 'Ethernet connection';
	        states[Connection.WIFI]     = 'WiFi connection';
	        states[Connection.CELL_2G]  = 'Cell 2G connection';
	        states[Connection.CELL_3G]  = 'Cell 3G connection';
	        states[Connection.CELL_4G]  = 'Cell 4G connection';
	        states[Connection.CELL]     = 'Cell generic connection';
        	states[Connection.NONE]     = 'No network connection';

       		document.getElementById("state").innerHTML = states[networkState];
      }
    </script>

</head>
<body>

	<div data-role="page" id="home" data-theme="a">
		<div data-role="header"><h1>Plugins test</h1></div><!-- /header -->

		<div role="main" class="ui-content">
			<ul data-role="listview" data-inset="true"> 
			 <li data-role="list-divider">MENU</li> 

			 	<li><a href="#camera" data-transition="slide">Camera</a></li> 
			 	<li><a href="#connection" data-transition="slide">Connection</a></li> 
			 	<li><a href="#accelerometer" data-transition="slide">Accelerometer</a></li> 
			 	
			</ul> 
		</div><!-- /content -->
	</div><!-- /page -->


	<div data-role="page" id="accelerometer" data-theme="a">
		<div data-role="header"><h1>Acelerometro</h1></div>

		<div role="main" class="ui-content">

			<p id="accelerometerStatus">carregando...</p>
		    <div id="boxCanvas" style="position:relative; width: 290px; height: 300px; border: 1px solid grey;">
		      <div id="box" style="position:absolute; width: 10px; height: 10px; left: 50%; top: 50%; background: blue;"></div>
		    </div><!-- /content -->

		</div>

		<div data-role="footer" data-position="fixed"><div data-role="navbar"><ul><li><a href="#home">Voltar</a></li></ul></div><!-- navbar --></div><!-- /footer -->
	</div>

	<div data-role="page" id="camera" data-theme="a">
		<div data-role="header"><h1>Camera</h1></div><!-- /header -->

		<div role="main" class="ui-content">
			<button onclick="capturePhoto();">Capture Photo</button> <br>
		    <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Photo Library</button><br>
		    <div style="text-align:center">
			    <img style="display:none;width:240px;height:240px;" id="smallImage" src="" />
		    </div>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed"><div data-role="navbar"><ul><li><a href="#home">Voltar</a></li></ul></div><!-- navbar --></div><!-- /footer -->
	</div><!-- /page -->	



	<div data-role="page" id="connection" data-theme="a">
		<div data-role="header"><h1>Conexão</h1></div><!-- /header -->

		<div role="main" class="ui-content">
			<p>Tipo de conexão: <span id="state">LOADING...</span></p>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed"><div data-role="navbar"><ul><li><a href="#home">Voltar</a></li></ul></div><!-- navbar --></div><!-- /footer -->
	</div><!-- /page -->	


 
    <script type="text/javascript">
		var watchID;

		$("#accelerometer").bind("pageshow",function(){

		  if (navigator.accelerometer) {

		 	watchID = navigator.accelerometer.watchAcceleration(accelerometerSuccess, accelerometerError, { frequency: 100 });

		  } else {

			accelerometerError('navigator.accelerometer not supported');
			window.addEventListener("devicemotion",devicemotionHandler,true);
		}


		  $("#accelerometer").bind("pagebeforehide",function(){

			    if (watchID) {
			      navigator.accelerometer.clearWatch(watchID);
			    } else {
			      window.removeEventListener("devicemotion",devicemotionHandler,true);
			    }
		    
			})
		});

		function devicemotionHandler(event){
			accelerometerSuccess(event.accelerationIncludingGravity);
		}

		function accelerometerSuccess(acceleration) {
			$("#accelerometerStatus").html('X: ' + acceleration.x + '<br />' +
			              'Y: ' + acceleration.y + '<br />' +
			              'Z: ' + acceleration.z);
			              
			var current = $("#box").position();

			$("#box").css({
			  left: checkValue(current.left - acceleration.x, 0, 280) + "px",
			  top: checkValue(current.top + acceleration.y, 0, 290) + "px",
			});
		}

		function checkValue(value,min,max){
			if(value<min){
			  value = min;
			} else if(value>max){
			  value = max;
			}
			return parseInt(value);
		}

		function accelerometerError(msg) {
			$("#accelerometerStatus").html(typeof msg == 'string' ? msg : "failed");
		}
  </script>

</body>
</html>
